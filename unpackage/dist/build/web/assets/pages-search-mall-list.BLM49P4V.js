import{n as e,b as s,p as a,c as t,w as o,i as l,o as c,d as r,q as d,u as n,F as i,e as h,g as u,I as f,j as m,S as _,t as g}from"./index-CDX771vS.js";import{_ as p}from"./left.CpwphMH_.js";import{a as k,_ as G}from"./camera.sMgFRGYR.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=y({data:()=>({refreshing:!1,searchPlaceholder:"请输入商品信息",searchKeyword:"",allGoods:[],matchedGoods:[],randomGoods:[]}),onLoad(e){e.keyword?(this.searchKeyword=decodeURIComponent(e.keyword),this.searchGoods()):this.getRandomGoods()},methods:{async onPullDownRefresh(){this.refreshing=!0,await this.searchGoods(),this.refreshing=!1},async getGoods(){try{const{result:{data:s}}=await e.database().collection("mall-goods").get();this.allGoods=s||[],this.allGoods.length>0&&(this.searchPlaceholder=this.allGoods[Math.floor(Math.random()*this.allGoods.length)].keywords||"请输入商品信息")}catch(s){console.error("获取商品数据失败:",s)}},async searchGoods(){await this.getGoods(),this.matchedGoods=this.allGoods.filter((e=>e.keywords&&e.keywords.split("").some((e=>this.searchKeyword.includes(e))))),0===this.matchedGoods.length&&this.getRandomGoods(10)},getRandomGoods(e=10){const s=[...this.allGoods].sort((()=>Math.random()-.5));this.randomGoods=s.slice(0,e)},navBack(){s({url:"/pages/search/search"})},navigateToSearch(){s({url:"/pages/search/search"})},navigateToProduct(e){e&&(a({key:"currentProduct",data:e,success:()=>{console.log("商品信息存储成功",e)}}),s({url:"../search/mall-details"}))}}},[["render",function(e,s,a,y,w,v){const C=u,P=f,b=l,R=m,x=_;return c(),t(b,{class:"container"},{default:o((()=>[r(b,{class:"fixed-head"},{default:o((()=>[r(b,{class:"search-container"},{default:o((()=>[r(C,{class:"search-icon",src:p,mode:"aspectFit",onClick:v.navBack},null,8,["onClick"]),r(b,{class:"search-box",onClick:v.navigateToSearch},{default:o((()=>[r(P,{class:"search-input",type:"text",modelValue:w.searchKeyword,"onUpdate:modelValue":s[0]||(s[0]=e=>w.searchKeyword=e),placeholder:w.searchPlaceholder},null,8,["modelValue","placeholder"]),r(C,{class:"search-icon",src:k,mode:"aspectFit"})])),_:1},8,["onClick"]),r(C,{class:"search-icon",src:G,mode:"aspectFit",onClick:v.searchGoods},null,8,["onClick"])])),_:1})])),_:1}),r(x,{"scroll-y":"","refresher-enabled":"","refresher-triggered":w.refreshing,onRefresherrefresh:v.onPullDownRefresh,class:"scroll-container"},{default:o((()=>[r(b,{class:"content"},{default:o((()=>[w.matchedGoods.length>0?(c(),t(b,{key:0,class:"tab-content"},{default:o((()=>[(c(!0),d(i,null,n(w.matchedGoods,((e,s)=>(c(),t(b,{key:s,class:"content-item"},{default:o((()=>[r(b,{class:"product-card",onClick:s=>v.navigateToProduct(e)},{default:o((()=>{var s;return[r(C,{class:"item-image",src:null==(s=e.goods_thumb)?void 0:s.fileID,mode:"aspectFit"},null,8,["src"]),r(b,{class:"product-info"},{default:o((()=>[r(R,{class:"item-title"},{default:o((()=>[h(g(e.name),1)])),_:2},1024),r(b,{class:"service-tags"},{default:o((()=>[r(R,{class:"tag pay-later"},{default:o((()=>[h("先用后付")])),_:1}),r(R,{class:"tag quick-refund"},{default:o((()=>[h("极速退款")])),_:1})])),_:1}),r(b,{class:"price-row"},{default:o((()=>[r(R,{class:"price"},{default:o((()=>[h("¥"+g(e.price),1)])),_:2},1024),r(R,{class:"sales"},{default:o((()=>[h("全店已拼"+g(e.total_sell_count)+"+件",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)]})),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})):(c(),t(b,{key:1,class:"no-results"},{default:o((()=>[r(R,{class:"no-results-text"},{default:o((()=>[h("暂时没有相关商品，请尝试搜索其他关键字或联系管理员更新，管理员：杨迪qq：3349476867")])),_:1}),r(R,{class:"other-recommendations"},{default:o((()=>[h("其他优质商品推荐:")])),_:1}),r(b,{class:"tab-content"},{default:o((()=>[(c(!0),d(i,null,n(w.randomGoods,((e,s)=>(c(),t(b,{key:s,class:"content-item"},{default:o((()=>[r(b,{class:"product-card",onClick:s=>v.navigateToProduct(e)},{default:o((()=>{var s;return[r(C,{class:"item-image",src:null==(s=e.goods_thumb)?void 0:s.fileID,mode:"aspectFit"},null,8,["src"]),r(b,{class:"product-info"},{default:o((()=>[r(R,{class:"item-title"},{default:o((()=>[h(g(e.name),1)])),_:2},1024),r(b,{class:"service-tags"},{default:o((()=>[r(R,{class:"tag pay-later"},{default:o((()=>[h("先用后付")])),_:1}),r(R,{class:"tag quick-refund"},{default:o((()=>[h("极速退款")])),_:1})])),_:1}),r(b,{class:"price-row"},{default:o((()=>[r(R,{class:"price"},{default:o((()=>[h("¥"+g(e.price),1)])),_:2},1024),r(R,{class:"sales"},{default:o((()=>[h("全店已拼"+g(e.total_sell_count)+"+件",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)]})),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}))])),_:1})])),_:1},8,["refresher-triggered","onRefresherrefresh"])])),_:1})}],["__scopeId","data-v-cd7cde61"]]);export{w as default};
