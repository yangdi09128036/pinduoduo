import{n as e,B as a,C as l,s as o,z as t,E as n,r as s,c as d,w as m,i as r,o as u,d as i,e as _,q as c,u as f,F as h,h as p,ap as b,f as g}from"./index-CDX771vS.js";import{_ as D}from"./uni-easyinput.D9N1AZ_4.js";import{r as V}from"./uni-app.es.i-bVV8oK.js";import{_ as w}from"./uni-forms-item.8sfQ-SvQ.js";import{v,_ as y}from"./mall-goods.ByehVgJr.js";import{_ as k}from"./uni-forms.Cwp0nF62.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.D1MAE8uI.js";const U=e.database();function j(e){let a={};for(let l in v)e.indexOf(l)>-1&&(a[l]=v[l]);return a}const I=C({data(){let e={category_id:"",goods_sn:"",name:"",price:null,keywords:"",goods_desc:"",goods_thumb:null,goods_banner_imgs:[],reviews:[""],remain_count:null,month_sell_count:null,total_sell_count:null,is_real:null,is_on_sale:null,is_best:null,is_new:null,is_hot:null,seller_note:""};return{formData:e,formOptions:{},rules:{...j(Object.keys(e))}}},onLoad(e){if(e.id){const a=e.id;this.formDataId=a,this.getDetail(a)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){a({mask:!0}),this.$refs.form.validate().then((e=>this.submitForm(e))).catch((()=>{})).finally((()=>{l()}))},submitForm(e){return U.collection("mall-goods").doc(this.formDataId).update(e).then((e=>{o({icon:"none",title:"修改成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>t()),500)})).catch((e=>{n({content:e.message||"请求服务失败",showCancel:!1})}))},getDetail(e){a({mask:!0}),U.collection("mall-goods").doc(e).field("category_id,goods_sn,name,price,keywords,goods_desc,goods_thumb,goods_banner_imgs,reviews,remain_count,month_sell_count,total_sell_count,is_real,is_on_sale,is_best,is_new,is_hot,seller_note").get().then((e=>{const a=e.result.data[0];a&&(this.formData=a)})).catch((e=>{n({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{l()}))},addReview(){this.formData.reviews.push("")},removeReview(e){this.formData.reviews.splice(e,1)}}},[["render",function(e,a,l,o,t,n){const v=V(s("uni-easyinput"),D),C=V(s("uni-forms-item"),w),U=V(s("uni-file-picker"),y),j=p,I=r,R=b,q=V(s("uni-forms"),k);return u(),d(I,{class:"uni-container"},{default:m((()=>[i(q,{ref:"form",model:t.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:m((()=>[i(C,{name:"category_id",label:"商品类别 ID",required:""},{default:m((()=>[i(v,{placeholder:"商品所属的分类 ID，参考 `opendb-mall-categories` 表。",modelValue:t.formData.category_id,"onUpdate:modelValue":a[0]||(a[0]=e=>t.formData.category_id=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"goods_sn",label:"货号",required:""},{default:m((()=>[i(v,{placeholder:"商品的唯一货号，用于区分不同商品。",modelValue:t.formData.goods_sn,"onUpdate:modelValue":a[1]||(a[1]=e=>t.formData.goods_sn=e),trim:"both"},null,8,["modelValue"])])),_:1}),i(C,{name:"name",label:"商品名称",required:""},{default:m((()=>[i(v,{placeholder:"商品的名称，用于展示和搜索。",modelValue:t.formData.name,"onUpdate:modelValue":a[2]||(a[2]=e=>t.formData.name=e),trim:"both"},null,8,["modelValue"])])),_:1}),i(C,{name:"price",label:"商品价格",required:""},{default:m((()=>[i(v,{placeholder:"商品的售价，单位为元。",type:"number",modelValue:t.formData.price,"onUpdate:modelValue":a[3]||(a[3]=e=>t.formData.price=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"keywords",label:"关键字"},{default:m((()=>[i(v,{placeholder:"商品的关键字，用于搜索引擎收录。",modelValue:t.formData.keywords,"onUpdate:modelValue":a[4]||(a[4]=e=>t.formData.keywords=e),trim:"both"},null,8,["modelValue"])])),_:1}),i(C,{name:"goods_desc",label:"详细描述"},{default:m((()=>[i(v,{placeholder:"商品的详细描述，支持多行文本。",modelValue:t.formData.goods_desc,"onUpdate:modelValue":a[5]||(a[5]=e=>t.formData.goods_desc=e),trim:"both"},null,8,["modelValue"])])),_:1}),i(C,{name:"goods_thumb",label:"缩略图"},{default:m((()=>[i(U,{"return-type":"object",modelValue:t.formData.goods_thumb,"onUpdate:modelValue":a[6]||(a[6]=e=>t.formData.goods_thumb=e)},null,8,["modelValue"])])),_:1}),_(" <"),i(C,{name:"goods_banner_imgs",label:"Banner 图"},{default:m((()=>[i(U,{"return-type":"object",multiple:!0,modelValue:t.formData.goods_banner_imgs,"onUpdate:modelValue":a[7]||(a[7]=e=>t.formData.goods_banner_imgs=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"reviews",label:"商品评价"},{default:m((()=>[(u(!0),c(h,null,f(t.formData.reviews,((e,a)=>(u(),d(I,{key:a,class:"review-item"},{default:m((()=>[i(v,{type:"textarea",placeholder:"请输入商品评价",modelValue:t.formData.reviews[a],"onUpdate:modelValue":e=>t.formData.reviews[a]=e,trim:"both"},null,8,["modelValue","onUpdate:modelValue"]),t.formData.reviews.length>1?(u(),d(j,{key:0,class:"remove-review-btn",type:"warn",size:"mini",onClick:e=>n.removeReview(a)},{default:m((()=>[_("删除")])),_:2},1032,["onClick"])):g("",!0)])),_:2},1024)))),128)),i(j,{class:"add-review-btn",type:"default",size:"mini",onClick:n.addReview},{default:m((()=>[_("添加评价")])),_:1},8,["onClick"])])),_:1}),i(C,{name:"remain_count",label:"库存数量"},{default:m((()=>[i(v,{placeholder:"商品的剩余库存数量。",type:"number",modelValue:t.formData.remain_count,"onUpdate:modelValue":a[8]||(a[8]=e=>t.formData.remain_count=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"month_sell_count",label:"月销量"},{default:m((()=>[i(v,{placeholder:"商品在本月的销售数量。",type:"number",modelValue:t.formData.month_sell_count,"onUpdate:modelValue":a[9]||(a[9]=e=>t.formData.month_sell_count=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"total_sell_count",label:"总销量"},{default:m((()=>[i(v,{placeholder:"商品的累计销售数量。",type:"number",modelValue:t.formData.total_sell_count,"onUpdate:modelValue":a[10]||(a[10]=e=>t.formData.total_sell_count=e)},null,8,["modelValue"])])),_:1}),i(C,{name:"is_real",label:"是否为实物"},{default:m((()=>[i(R,{onChange:a[11]||(a[11]=a=>e.binddata("is_real",a.detail.value)),checked:t.formData.is_real},null,8,["checked"])])),_:1}),i(C,{name:"is_on_sale",label:"是否上架"},{default:m((()=>[i(R,{onChange:a[12]||(a[12]=a=>e.binddata("is_on_sale",a.detail.value)),checked:t.formData.is_on_sale},null,8,["checked"])])),_:1}),i(C,{name:"is_best",label:"是否精品"},{default:m((()=>[i(R,{onChange:a[13]||(a[13]=a=>e.binddata("is_best",a.detail.value)),checked:t.formData.is_best},null,8,["checked"])])),_:1}),i(C,{name:"is_new",label:"是否新品"},{default:m((()=>[i(R,{onChange:a[14]||(a[14]=a=>e.binddata("is_new",a.detail.value)),checked:t.formData.is_new},null,8,["checked"])])),_:1}),i(C,{name:"is_hot",label:"是否热销"},{default:m((()=>[i(R,{onChange:a[15]||(a[15]=a=>e.binddata("is_hot",a.detail.value)),checked:t.formData.is_hot},null,8,["checked"])])),_:1}),i(C,{name:"seller_note",label:"商家备注"},{default:m((()=>[i(v,{placeholder:"商家对商品的备注信息，仅商家可见。",modelValue:t.formData.seller_note,"onUpdate:modelValue":a[16]||(a[16]=e=>t.formData.seller_note=e),trim:"both"},null,8,["modelValue"])])),_:1}),i(I,{class:"uni-button-group"},{default:m((()=>[i(j,{type:"primary",class:"uni-button",onClick:n.submit},{default:m((()=>[_("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})}],["__scopeId","data-v-1aada7df"]]);export{I as default};
